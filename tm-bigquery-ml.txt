https://partner.cloudskillsboost.google/focuses/22611?catalog_rank=%7B%22rank%22%3A1%2C%22num_filters%22%3A0%2C%22has_search%22%3Atrue%7D&parent=catalog&search_id=19584479

dataset:fin_market_forecast
table=set_index_price
source file=D:\PythonDev\MyQuantFinProject\Market-TM-ML\data

ARIMA_PLUS
CREATE OR REPLACE MODEL FinMarketML.set_index_trend_model
  OPTIONS(
    MODEL_TYPE='ARIMA_PLUS',
    TIME_SERIES_TIMESTAMP_COL='datetime',
    TIME_SERIES_DATA_COL='rsi_ma',
    HOLIDAY_REGION='TH'
  ) AS
  SELECT
    datetime,
    rsi_ma
  FROM
   FinMarketML.set_index_price


SELECT
  *
FROM
  ML.EVALUATE(MODEL FinMarketML.set_index_trend_model)


DECLARE HORIZON STRING DEFAULT "60"; #number of values to forecast
 DECLARE CONFIDENCE_LEVEL STRING DEFAULT "0.90";
 EXECUTE IMMEDIATE format("""
     SELECT
         *
     FROM
       ML.FORECAST(MODEL FinMarketML.set_index_trend_model,
                   STRUCT(%s AS horizon,
                          %s AS confidence_level)
                  )
     """, HORIZON, CONFIDENCE_LEVEL)